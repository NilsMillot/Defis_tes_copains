{% extends 'base_front.html.twig' %}
{% set currentUser = "" %}
{% block title %}Vos amis
{% endblock %}

{% block body %}
	<link href="{{ asset('css/friends.css') }}" rel="stylesheet"/>
	<h1>Vos amis / Demandes d'amis</h1>
	<div style="display: flex; justify-content: space-around; align-items: center; flex-wrap: wrap-reverse;">
		<section id="sectionSearchFriends" style="min-width: 420px; margin: 0 5px;">
			<section id="friends_search_section" style="background: slategray; border-radius: 50px; padding: 0 20px">
				{{ form_start(formSearch) }}
				{{ form_row(formSearch.name) }}
				<button style="background: none; cursor: pointer; padding-top: 5px">
					<i class="material-icons">search</i>
				</button>
				{{ form_end(formSearch) }}
			</section>
			<div style="min-width: 420px max-width: 720px; max-height: 60vh; overflow: scroll; margin-top: 20px; border-radius: 20px" class="collection">
				{% if arrUsers|length > 0 %}
					{% set currentUser = app.user %}
					{% for friend in arrUsers %}
						<div style="position: relative; border-bottom: 1px solid #e0e0e0;">
							{% if friend not in usersAcceptedOrSent  %}
								<a href="{{ path('friends_sendRequest', {'id': friend.id}) }}" class="collection-item-send-request" style="position: absolute; z-index: 1; top: 30px; right: 10px; color: black">Envoyer une demande d'ami</a>
							{% endif %}
							<a href="/user/{{ friend.id }}" class="collection-item avatar" style="display: flex; align-items: center;">
								<img src="http://i.pravatar.cc/500" alt="" class="circle">

								<span>{{ friend.username }}</span>
							</a>
						</div>
					{% endfor %}

				{% elseif usersAccepted|length > 0 %}
					{% for friend in usersAccepted %}
						{# <li class="collection-item avatar" style="display: flex; align-items: center;">
														<img src="images/yuna.jpg" alt="" class="circle">
							
														<a href="/user/{{ friend.id }}">{{ friend.username }}</a>
													</li> #}
						<div style="position: relative; border-bottom: 1px solid #e0e0e0;">
							{% if friend[1] in usersAcceptedOrSent  %}
								{# <a href="#" class="collection-item-delete-request" style="position: absolute; z-index: 1; top: 30px; right: 10px; color: black">
																		<i class="material-icons">delete</i>
																	</a> #}
								{{ include('friends/_delete_form_2.html.twig') }}

							{% endif %}
							<a href="/user/{{ friend[1].id }}" class="collection-item avatar" style="display: flex; align-items: center;">
								<img src="http://i.pravatar.cc/500" alt="" class="circle">

								<span>{{ friend[1].username }}</span>
							</a>
						</div>
					{% endfor %}

				{% else %}
					<li class="collection-item" style="display: flex; align-items: center;">
						<span>Aucun ami</span>
					</li>
				{% endif %}

			</div>
		</section>


		<section style="margin: 0 5px;">
			<h4 style="margin-top: 12px">Vos notifications</h4>
			<ul style="max-width: 420px; max-height: 60vh; overflow: scroll; border-radius: 20px" class="collection">
				{% set currentUser = app.user %}
				{% for friend in friendsRequestsOfCurrentUser %}
					<li class="collection-item avatar" style="display: flex; align-items: center;">
						<img src="http://i.pravatar.cc/500" alt="" class="circle">
						{% if friend.receiverUser.id is same as currentUser.id %}
							<span>
								<a style="color: black;" href="/user/{{ friend.senderUser.id }}">{{ friend.senderUser.username }}</a>
							</span>
						{% else %}
							<span>
								<a style="color: black;" href="/user/{{ friend.receiverUser.id }}">{{ friend.receiverUser.username }}</a>
							</span>
						{% endif %}
						{% if friend.status is same as('sent') and friend.receiverUser.id is not same as currentUser.id %}
							<span style="margin-left: 8px">
								- demande envoy√©e...</span>
						{% endif %}
						{% if friend.status is same as('sent') and friend.receiverUser.id is same as currentUser.id %}
							<span style="margin-left: 8px">
								- accepter la demande ?</span>
							<a style="color: green; margin: 5px 0 0 8px" href="{{ path('friends_accept', {'id': friend.id}) }}">
								<i class="material-icons">check</i>
							</a>
							{{ include('friends/_delete_form.html.twig') }}

						{% endif %}
						{% if friend.status is not same as('sent') %}
							<div style="position: absolute; top: 16px; right: 16px;">
								<a href="#!" style="color: green;">
									<i class="material-icons">check</i>
								</a>
								<a href="#!" style="color: red;">
									<i class="material-icons">clear</i>
								</a>
							</div>

						{% endif %}
					</li>
				{% endfor %}
				{% if friendsRequestsOfCurrentUser|length == 0 %}
					<li class="collection-item" style="display: flex; align-items: center;">
						<span>Vous n'avez aucune notif</span>
					</li>
				{% endif %}
			</ul>
		</section>
	</div>
{% endblock %}
